# ДЗ №5 - Экспорт моделей в различные форматы

В данном задании мы экспортируем модель `google/vit-base-patch16-224-in21k` в форматы ONNX, TorchScript и OpenVINO, а затем сравниваем производительность оригинальной модели и экспортированных версий.

## Данные для тестирования

В качестве набора данных для тестирования моделей используется датасет `beans` - набор изображений бобовых культур, разделенных на классы. Этот датасет позволяет оценить качество классификации моделей компьютерного зрения при работе с сельскохозяйственными изображениями.

## Порядок работы каждого файла
1. Загружает модель `google/vit-base-patch16-224-in21k` и датасет `beans`
2. Измеряет производительность оригинальной модели
3. Экспортирует модель в различные форматы
4. Измеряет производительность экспортированных моделей
5. Создает таблицу сравнения и сохраняет результаты

## Таблица результатов для GPU-оптимизированных моделей

Сравнение производительности GPU-оптимизированных форматов (ONNX и TorchScript) с оригинальной моделью:

| Модель                            | Метод       | Размер весов | Время инференса (GPU, ms) | Использование RAM (MB) | Использование VRAM (MB) | Качество (Accuracy) |
|:----------------------------------|:------------|:-------------|:--------------------------|:-----------------------|:------------------------|:--------------------|
| google/vit-base-patch16-224-in21k | Оригинал    | 327.30Mb     | 331.66ms                  | 4414.42Mb              | 2046.64Mb               | 62.50%              |
| google/vit-base-patch16-224-in21k | ONNX        | 327.35Mb     | 365.91ms                  | 4452.41Mb              | 2046.64Mb               | 62.50%              |
| google/vit-base-patch16-224-in21k | TorchScript | 327.35Mb     | 346.89ms                  | 4451.88Mb              | 2452.32Mb               | 62.50%              |

### Выводы по GPU-оптимизированным моделям:

1. **Размер моделей**: Размер весов для всех трех вариантов практически идентичен (~327 МБ). Это говорит о том, что ни ONNX, ни TorchScript не выполняют существенного сжатия параметров модели.

2. **Производительность**: Оригинальная модель показывает немного лучшее время инференса на GPU (331.66ms), чем TorchScript (346.89ms) и ONNX (365.91ms), что несколько неожиданно, так как обычно оптимизированные форматы должны работать быстрее.

3. **Использование памяти**: Все три варианта имеют схожее потребление оперативной памяти (~4.4 ГБ), но TorchScript использует немного больше VRAM (2452.32 МБ против 2046.64 МБ у других вариантов).

## Таблица результатов для CPU-оптимизированных моделей

Сравнение производительности CPU-оптимизированного формата OpenVINO с оригинальной моделью на CPU:

| Модель                            | Метод    | Размер весов | Время инференса (CPU, ms) | Использование RAM (MB) | Качество (Accuracy) |
|:----------------------------------|:---------|:-------------|:--------------------------|:-----------------------|:--------------------|
| google/vit-base-patch16-224-in21k | Оригинал | 327.30Mb     | 2641.97ms                 | 5218.03Mb              | 62.50%              |
| google/vit-base-patch16-224-in21k | OpenVINO | 164.15Mb     | 3272.96ms                 | 5948.23Mb              | 62.50%              |

### Выводы по CPU-оптимизированным моделям:

1. **Размер модели**: OpenVINO значительно уменьшает размер весов (164.15 МБ против 327.30 МБ), что составляет сокращение примерно на 50%. Это существенное преимущество, особенно для устройств с ограниченной памятью.

2. **Производительность**: Вопреки ожиданиям, OpenVINO модель работает медленнее оригинальной на CPU (3272.96ms против 2641.97ms). Это может быть связано с дополнительными оптимизациями, которые увеличивают задержку первого запуска, или с особенностями тестового окружения.

3. **Использование памяти**: OpenVINO требует больше оперативной памяти (5948.23 МБ против 5218.03 МБ), что может быть связано с дополнительными буферами и структурами данных, необходимыми для оптимизации.